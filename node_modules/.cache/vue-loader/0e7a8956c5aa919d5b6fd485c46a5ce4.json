{"remainingRequest":"/Users/apple/Desktop/simple-twitter-vue/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/apple/Desktop/simple-twitter-vue/src/views/Login.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/apple/Desktop/simple-twitter-vue/src/views/Login.vue","mtime":1665173882181},{"path":"/Users/apple/Desktop/simple-twitter-vue/node_modules/cache-loader/dist/cjs.js","mtime":1665037748930},{"path":"/Users/apple/Desktop/simple-twitter-vue/node_modules/babel-loader/lib/index.js","mtime":1665037748499},{"path":"/Users/apple/Desktop/simple-twitter-vue/node_modules/cache-loader/dist/cjs.js","mtime":1665037748930},{"path":"/Users/apple/Desktop/simple-twitter-vue/node_modules/vue-loader/lib/index.js","mtime":1665037757708}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmltcG9ydCB7IFRvYXN0IH0gZnJvbSAiLi8uLi91dGlscy9oZWxwZXJzIjsKaW1wb3J0IGF1dGhvcml6YXRpb25BUEkgZnJvbSAiLi8uLi9hcGlzL2F1dGhvcml6YXRpb24iOwoKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICJMb2dJbiIsCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGFjY291bnQ6ICIiLAogICAgICBwYXNzd29yZDogIiIsCiAgICAgIGlzUHJvY2Vzc2luZzogZmFsc2UsCiAgICAgIGVycm9yTXNnOiAiIiwKICAgIH07CiAgfSwKICBtZXRob2RzOiB7CiAgICBhc3luYyBoYW5kbGVTdWJtaXQoKSB7CiAgICAgIHRyeSB7CiAgICAgICAgLy8g5YWI5oqK6Yyv6Kqk6KiK5oGv5riF56m6CiAgICAgICAgdGhpcy5lcnJvck1zZyA9ICIiOwoKICAgICAgICAvL+ihqOWWrumpl+itieWkseaVlwogICAgICAgIGlmICghdGhpcy5hY2NvdW50IHx8ICF0aGlzLnBhc3N3b3JkKSB7CiAgICAgICAgICBUb2FzdC5maXJlKHsKICAgICAgICAgICAgaWNvbjogIndhcm5pbmciLAogICAgICAgICAgICB0aXRsZTogIuiri+Whq+WFpeW4s+iZn+WSjOWvhueivCIsCiAgICAgICAgICB9KTsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIC8vIOihqOWWrumpl+itieaIkOWKnwogICAgICAgIC8vIOiuk+eZu+WFpeaMiemIleWkseaViAogICAgICAgIHRoaXMuaXNQcm9jZXNzaW5nID0gdHJ1ZTsKICAgICAgICAvLyDlsIfluLPlr4bpgI/pgY4gQVBJIOWCs+WbnuS8uuacjeWZqOmpl+itiQogICAgICAgIGNvbnN0IHsgZGF0YSB9ID0gYXdhaXQgYXV0aG9yaXphdGlvbkFQSS5zaWduSW4oewogICAgICAgICAgYWNjb3VudDogdGhpcy5hY2NvdW50LAogICAgICAgICAgcGFzc3dvcmQ6IHRoaXMucGFzc3dvcmQsCiAgICAgICAgfSk7CiAgICAgICAgLy8g5biz5a+G6amX6K2J5aSx5pWXIOS4n+WHuumMr+iqpAogICAgICAgIGlmIChkYXRhLnN0YXR1cyA9PT0gImVycm9yIikgewogICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGRhdGEubWVzc2FnZSk7CiAgICAgICAgfQogICAgICAgIC8vIOW4s+Wvhumpl+itieaIkOWKnwogICAgICAgIC8vIOWwhyB0b2tlbiDlrZjmlL7lnKggbG9jYWxTdG9yYWdlIOWFpwogICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCJ0b2tlbiIsIGRhdGEudG9rZW4pOwogICAgICAgIC8vIOaKikFQSeWbnuWCs+eahOeZu+WFpeS9v+eUqOiAheizh+aWmeWtmOWIsFZ1ZXgKICAgICAgICB0aGlzLiRzdG9yZS5jb21taXQoInNldEN1cnJlbnRVc2VyIiwgZGF0YS51c2VyKTsKICAgICAgICAvLyDnmbvlhaXmiJDlip8sIOebtOaOpei9ieWdgOWIsOmmlumggQogICAgICAgIC8vIOWboOeCuuaIkOWKn+eZu+WFpeWwseacg+i9ieWdgO+8jOaJgOS7peS4jeeUqOmChOWOnyBpc1Byb2Nlc3Npbmcg55qE54uA5oWLCiAgICAgICAgdGhpcy4kcm91dGVyLnB1c2goIi9tYWluIik7CiAgICAgICAgCiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgLy8g5biz6Jmf5oiW5a+G56K86Ly45YWl6Yyv6Kqk5b6M77yM5bCH5a+G56K85qyE5L2N5riF56m6CiAgICAgICAgdGhpcy5wYXNzd29yZCA9ICIiOwogICAgICAgIC8vIOWboOeCuueZu+WFpeWkseaVl++8jOaJgOS7peimgeaKiuaMiemIleeLgOaFi+mChOWOnwogICAgICAgIHRoaXMuaXNQcm9jZXNzaW5nID0gZmFsc2U7CiAgICAgICAgY29uc29sZS5lcnJvcihlcnJvci5tZXNzYWdlKTsKICAgICAgICBpZiAoZXJyb3IubWVzc2FnZSA9PT0gIlRoaXMgYWNjb3VudCBkaWRuJ3QgZXhpc3QhIikgewogICAgICAgICAgdGhpcy5lcnJvck1zZyA9IGVycm9yLm1lc3NhZ2U7CiAgICAgICAgICBUb2FzdC5maXJlKHsKICAgICAgICAgICAgaWNvbjogImVycm9yIiwKICAgICAgICAgICAgdGl0bGU6ICLluLPomZ/kuI3lrZjlnKgiLAogICAgICAgICAgfSk7CiAgICAgICAgfSBlbHNlIGlmIChlcnJvci5tZXNzYWdlID09PSAicGFzc3dvcmQgaXMgaW5jb3JyZWN077yBIikgewogICAgICAgICAgdGhpcy5lcnJvck1zZyA9IGVycm9yLm1lc3NhZ2U7CiAgICAgICAgICBUb2FzdC5maXJlKHsKICAgICAgICAgICAgaWNvbjogImVycm9yIiwKICAgICAgICAgICAgdGl0bGU6ICLlr4bnorzpjK/oqqQiLAogICAgICAgICAgfSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRoaXMuZXJyb3JNc2cgPSBlcnJvci5tZXNzYWdlOwogICAgICAgICAgVG9hc3QuZmlyZSh7CiAgICAgICAgICAgIGljb246ICJlcnJvciIsCiAgICAgICAgICAgIHRpdGxlOiAi54Sh5rOV5oiQ5Yqf55m75YWl77yM6KuL56iN5b6M5YaN6KmmIiwKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfQogICAgfSwKICB9LAp9Owo="},{"version":3,"sources":["Login.vue"],"names":[],"mappings":";AA0EA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Login.vue","sourceRoot":"src/views","sourcesContent":["<template>\n  <div class=\"mx-auto\" style=\"width: 400px\">\n    <div class=\"mx-auto\" style=\"width: 40px\">\n      <img\n        class=\"mx-auto mt-5\"\n        width=\"40px\"\n        src=\"https://i.postimg.cc/Dfp23k8g/logo-2x.png\"\n        alt=\"LogoImage\"\n      />\n    </div>\n    <h3 class=\"text-center font-weight-bold mt-4\">登入 Alphitter</h3>\n\n    <form @submit.prevent.stop=\"handleSubmit\">\n      <div class=\"form-wrapper mt-5\">\n        <label for=\"account\">帳號</label>\n        <div>\n          <input\n            id=\"account\"\n            v-model=\"account\"\n            name=\"account\"\n            type=\"text\"\n            class=\"form\"\n            placeholder=\"請輸入帳號\"\n            required\n            autofocus\n          />\n          <div class=\"error-alert\">\n            <span class=\"msg\" v-if=\"errorMsg === `This account didn't exist!`\"\n              >帳號不存在</span\n            >\n          </div>\n        </div>\n      </div>\n\n      <div class=\"form-wrapper mt-4\">\n        <label for=\"password\">密碼</label>\n        <div>\n          <input\n            id=\"password\"\n            v-model=\"password\"\n            name=\"password\"\n            type=\"password\"\n            class=\"form\"\n            placeholder=\"請輸入密碼\"\n            autocomplete=\"current-password\"\n            required\n          />\n          <div class=\"error-alert\">\n            <span class=\"msg\" v-if=\"errorMsg === 'password is incorrect！'\"\n              >密碼錯誤</span\n            >\n          </div>\n        </div>\n      </div>\n\n      <div class=\"mt-4\">\n        <button\n          type=\"submit\"\n          class=\"btn btn-info btn-singin\"\n          :disabled=\"isProcessing\"\n        >\n          {{ isProcessing ? \"驗證中\" : \"登入\" }}\n        </button>\n      </div>\n    </form>\n    <div class=\"d-flex mt-4 justify-content-end\">\n      <router-link class=\"mx-1\" to=\"/signup\"> 註冊 </router-link>\n      <span>・</span>\n      <router-link class=\"mx-1\" to=\"/admin\"> 後台登入 </router-link>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { Toast } from \"./../utils/helpers\";\nimport authorizationAPI from \"./../apis/authorization\";\n\nexport default {\n  name: \"LogIn\",\n  data() {\n    return {\n      account: \"\",\n      password: \"\",\n      isProcessing: false,\n      errorMsg: \"\",\n    };\n  },\n  methods: {\n    async handleSubmit() {\n      try {\n        // 先把錯誤訊息清空\n        this.errorMsg = \"\";\n\n        //表單驗證失敗\n        if (!this.account || !this.password) {\n          Toast.fire({\n            icon: \"warning\",\n            title: \"請填入帳號和密碼\",\n          });\n          return;\n        }\n\n        // 表單驗證成功\n        // 讓登入按鈕失效\n        this.isProcessing = true;\n        // 將帳密透過 API 傳回伺服器驗證\n        const { data } = await authorizationAPI.signIn({\n          account: this.account,\n          password: this.password,\n        });\n        // 帳密驗證失敗 丟出錯誤\n        if (data.status === \"error\") {\n          throw new Error(data.message);\n        }\n        // 帳密驗證成功\n        // 將 token 存放在 localStorage 內\n        localStorage.setItem(\"token\", data.token);\n        // 把API回傳的登入使用者資料存到Vuex\n        this.$store.commit(\"setCurrentUser\", data.user);\n        // 登入成功, 直接轉址到首頁\n        // 因為成功登入就會轉址，所以不用還原 isProcessing 的狀態\n        this.$router.push(\"/main\");\n        \n      } catch (error) {\n        // 帳號或密碼輸入錯誤後，將密碼欄位清空\n        this.password = \"\";\n        // 因為登入失敗，所以要把按鈕狀態還原\n        this.isProcessing = false;\n        console.error(error.message);\n        if (error.message === \"This account didn't exist!\") {\n          this.errorMsg = error.message;\n          Toast.fire({\n            icon: \"error\",\n            title: \"帳號不存在\",\n          });\n        } else if (error.message === \"password is incorrect！\") {\n          this.errorMsg = error.message;\n          Toast.fire({\n            icon: \"error\",\n            title: \"密碼錯誤\",\n          });\n        } else {\n          this.errorMsg = error.message;\n          Toast.fire({\n            icon: \"error\",\n            title: \"無法成功登入，請稍後再試\",\n          });\n        }\n      }\n    },\n  },\n};\n</script>\n\n\n<style lang=\"scss\">\n@import \"../assets/scss/login.scss\";\n</style>"]}]}