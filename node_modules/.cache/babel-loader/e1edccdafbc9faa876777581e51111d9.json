{"remainingRequest":"/Users/apple/Desktop/simple-twitter-vue/node_modules/babel-loader/lib/index.js!/Users/apple/Desktop/simple-twitter-vue/node_modules/cache-loader/dist/cjs.js??ref--1-0!/Users/apple/Desktop/simple-twitter-vue/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/apple/Desktop/simple-twitter-vue/src/views/Login.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/apple/Desktop/simple-twitter-vue/src/views/Login.vue","mtime":1665251958072},{"path":"/Users/apple/Desktop/simple-twitter-vue/babel.config.js","mtime":1665155868062},{"path":"/Users/apple/Desktop/simple-twitter-vue/node_modules/cache-loader/dist/cjs.js","mtime":1665037748930},{"path":"/Users/apple/Desktop/simple-twitter-vue/node_modules/babel-loader/lib/index.js","mtime":1665037748499},{"path":"/Users/apple/Desktop/simple-twitter-vue/node_modules/cache-loader/dist/cjs.js","mtime":1665037748930},{"path":"/Users/apple/Desktop/simple-twitter-vue/node_modules/vue-loader/lib/index.js","mtime":1665037757708}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZXJyb3IuY2F1c2UuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5wdXNoLmpzIjsKaW1wb3J0IHsgVG9hc3QgfSBmcm9tICIuLy4uL3V0aWxzL2hlbHBlcnMiOwppbXBvcnQgYXV0aG9yaXphdGlvbkFQSSBmcm9tICIuLy4uL2FwaXMvYXV0aG9yaXphdGlvbiI7CmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAiTG9nSW4iLAoKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgYWNjb3VudDogIiIsCiAgICAgIHBhc3N3b3JkOiAiIiwKICAgICAgaXNQcm9jZXNzaW5nOiBmYWxzZSwKICAgICAgZXJyb3JNc2c6ICIiCiAgICB9OwogIH0sCgogIG1ldGhvZHM6IHsKICAgIGFzeW5jIGhhbmRsZVN1Ym1pdCgpIHsKICAgICAgdHJ5IHsKICAgICAgICAvLyDph43mlrDoqK3lrprpjK/oqqToqIrmga8KICAgICAgICB0aGlzLmVycm9yTXNnID0gIiI7IC8vIOihqOWWrumpl+itieWkseaVl++8muaUlOaIquaDoeaEj+aLv+aOieW4s+WvhiByZXF1aXJlZCDlsazmgKfogIzpgIHlh7rooajllq7nmoTni4Dms4EKCiAgICAgICAgaWYgKCF0aGlzLmFjY291bnQgfHwgIXRoaXMucGFzc3dvcmQpIHsKICAgICAgICAgIC8vIFNURVAxLiDlpoLmnpwgZW1haWwg5oiWIHBhc3N3b3JkIOeCuuepuu+8jOWJh+S9v+eUqCBUb2FzdCDmj5DnpLoKICAgICAgICAgIFRvYXN0LmZpcmUoewogICAgICAgICAgICBpY29uOiAid2FybmluZyIsCiAgICAgICAgICAgIHRpdGxlOiAi6KuL6Ly45YWl5biz6Jmf5ZKM5a+G56K8IgogICAgICAgICAgfSk7IC8vIFNURVAyLiDnhLblvowgcmV0dXJuIOS4jee5vOe6jOW+gOW+jOWft+ihjAoKICAgICAgICAgIHJldHVybjsKICAgICAgICB9IC8vIOihqOWWrumpl+itieaIkOWKn++8muW4s+WvhueahuacieWhq+WvqwogICAgICAgIC8vIFNURVAxLiDorpPnmbvlhaXmjInpiJXlpLHmlYgKCgogICAgICAgIHRoaXMuaXNQcm9jZXNzaW5nID0gdHJ1ZTsgLy8gU1RFUDIuIOWwh+W4s+WvhumAj+mBjiBBUEkg6YCB5Zue5Ly65pyN5Zmo6amX6K2JCgogICAgICAgIGNvbnN0IHsKICAgICAgICAgIGRhdGEKICAgICAgICB9ID0gYXdhaXQgYXV0aG9yaXphdGlvbkFQSS5zaWduSW4oewogICAgICAgICAgYWNjb3VudDogdGhpcy5hY2NvdW50LAogICAgICAgICAgcGFzc3dvcmQ6IHRoaXMucGFzc3dvcmQKICAgICAgICB9KTsgLy8gU1RFUDMtMS4g5biz5a+G6amX6K2J5aSx5pWX77yMQVBJIOWbnuWCs+mMr+iqpAoKICAgICAgICBpZiAoZGF0YS5zdGF0dXMgPT09ICJlcnJvciIpIHsKICAgICAgICAgIHRocm93IG5ldyBFcnJvcihkYXRhLm1lc3NhZ2UpOwogICAgICAgIH0gLy8gU1RFUDMtMi4g5biz5a+G6amX6K2J5oiQ5YqfCiAgICAgICAgLy8g5bCHIHRva2VuIOWtmOWcqCBsb2NhbFN0b3JhZ2Ug6KOhCgoKICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgidG9rZW4iLCBkYXRhLnRva2VuKTsgLy8g5oqKIEFQSSDlm57lgrPnmoTnm67liY3kvb/nlKjogIXos4fmlpnlrZjpgLIgVnVleCDoo6EKICAgICAgICAvLyB0aGlzLiRzdG9yZS5jb21taXQoInNldEN1cnJlbnRVc2VyIiwgZGF0YS51c2VyKTsKICAgICAgICAvLyDnmbvlhaXmiJDlip8sIOebtOaOpei9ieWdgOWIsOmmlumggSDvvIjkuI3pnIDpgoTljp8gaXNQcm9jZXNzaW5nIOeahOeLgOaFi++8iQoKICAgICAgICB0aGlzLiRyb3V0ZXIucHVzaCgiL21haW4iKTsKICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICAvLyDluLPomZ/miJblr4bnorzovLjlhaXpjK/oqqTlvozvvIzlsIflr4bnorzmrITkvY3muIXnqboKICAgICAgICB0aGlzLnBhc3N3b3JkID0gIiI7IC8vIOWboOeCuueZu+WFpeWkseaVl++8jOaJgOS7peimgeaKiuaMiemIleeLgOaFi+mChOWOnwoKICAgICAgICB0aGlzLmlzUHJvY2Vzc2luZyA9IGZhbHNlOyAvLyDpjK/oqqTpgJrnn6XomZXnkIYKCiAgICAgICAgY29uc29sZS5lcnJvcihlcnJvci5tZXNzYWdlKTsKICAgICAgICB0aGlzLmVycm9yTXNnID0gZXJyb3IubWVzc2FnZTsKCiAgICAgICAgaWYgKGVycm9yLm1lc3NhZ2UgPT09ICLmraTluLPomZ/kuI3lrZjlnKghIikgewogICAgICAgICAgVG9hc3QuZmlyZSh7CiAgICAgICAgICAgIGljb246ICJlcnJvciIsCiAgICAgICAgICAgIHRpdGxlOiAi5biz6Jmf5LiN5a2Y5Zyo77yM6KuL6YeN5paw56K66KqNIgogICAgICAgICAgfSk7CiAgICAgICAgfSBlbHNlIGlmIChlcnJvci5tZXNzYWdlID09PSAi5a+G56K86Yyv6KqkISIpIHsKICAgICAgICAgIFRvYXN0LmZpcmUoewogICAgICAgICAgICBpY29uOiAiZXJyb3IiLAogICAgICAgICAgICB0aXRsZTogIuWvhueivOmMr+iqpO+8jOiri+mHjeaWsOi8uOWFpSIKICAgICAgICAgIH0pOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBUb2FzdC5maXJlKHsKICAgICAgICAgICAgaWNvbjogImVycm9yIiwKICAgICAgICAgICAgdGl0bGU6ICLnhKHms5XnmbvlhaXvvIzoq4vnqI3lvozlho3oqaYiCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgfQp9Ow=="},{"version":3,"mappings":";;AA0EA;AACA;AAEA;EACAA,aADA;;EAEAC;IACA;MACAC,WADA;MAEAC,YAFA;MAGAC,mBAHA;MAIAC;IAJA;EAMA,CATA;;EAUAC;IACA;MACA;QACA;QACA,mBAFA,CAIA;;QACA;UACA;UACAC;YACAC,eADA;YAEAC;UAFA,GAFA,CAMA;;UACA;QACA,CAbA,CAeA;QACA;;;QACA,yBAjBA,CAmBA;;QACA;UAAAR;QAAA;UACAC,qBADA;UAEAC;QAFA,GApBA,CAyBA;;QACA;UACA;QACA,CA5BA,CA8BA;QACA;;;QACAO,0CAhCA,CAkCA;QACA;QAEA;;QACA;MACA,CAvCA,CAuCA;QACA;QACA,mBAFA,CAIA;;QACA,0BALA,CAOA;;QACAC;QACA;;QACA;UACAJ;YACAC,aADA;YAEAC;UAFA;QAIA,CALA,MAKA;UACAF;YACAC,aADA;YAEAC;UAFA;QAIA,CALA,MAKA;UACAF;YACAC,aADA;YAEAC;UAFA;QAIA;MACA;IACA;;EApEA;AAVA","names":["name","data","account","password","isProcessing","errorMsg","methods","Toast","icon","title","localStorage","console"],"sourceRoot":"src/views","sources":["Login.vue"],"sourcesContent":["<template>\n  <div class=\"mx-auto\" style=\"width: 400px\">\n    <div class=\"mx-auto\" style=\"width: 40px\">\n      <img\n        class=\"mx-auto mt-5\"\n        width=\"40px\"\n        src=\"https://i.postimg.cc/Dfp23k8g/logo-2x.png\"\n        alt=\"LogoImage\"\n      />\n    </div>\n    <h3 class=\"title text-center font-weight-bold mt-4\">登入 Alphitter</h3>\n\n    <form @submit.prevent.stop=\"handleSubmit\">\n      <div class=\"form-wrapper\">\n        <label for=\"account\">帳號</label>\n        <div>\n          <input\n            id=\"account\"\n            v-model=\"account\"\n            name=\"account\"\n            type=\"text\"\n            class=\"form\"\n            :class=\"{ redBottomLine: errorMsg === '此帳號不存在!' }\"\n            placeholder=\"請輸入帳號\"\n            required\n            autofocus\n          />\n          <div class=\"error-alert\">\n            <span class=\"msg\" v-if=\"errorMsg === '此帳號不存在!'\"\n              >帳號不存在</span\n            >\n          </div>\n        </div>\n      </div>\n\n      <div class=\"form-wrapper\">\n        <label for=\"password\">密碼</label>\n        <div>\n          <input\n            id=\"password\"\n            v-model=\"password\"\n            name=\"password\"\n            type=\"password\"\n            class=\"form\"\n            :class=\"{ redBottomLine: errorMsg === '密碼錯誤!' }\"\n            placeholder=\"請輸入密碼\"\n            autocomplete=\"current-password\"\n            required\n          />\n          <div class=\"error-alert\">\n            <span class=\"msg\" v-if=\"errorMsg === '密碼錯誤!'\">密碼錯誤</span>\n          </div>\n        </div>\n      </div>\n\n      <div class=\"mt-4\">\n        <button\n          type=\"submit\"\n          class=\"btn btn-info btn-singin\"\n          :disabled=\"isProcessing\"\n        >\n          {{ isProcessing ? \"驗證中\" : \"登入\" }}\n        </button>\n      </div>\n    </form>\n    <div class=\"d-flex mt-4 justify-content-end\">\n      <router-link class=\"mx-1\" to=\"/signup\"> 註冊 </router-link>\n      <span>・</span>\n      <router-link class=\"mx-1\" to=\"/admin\"> 後台登入 </router-link>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { Toast } from \"./../utils/helpers\";\nimport authorizationAPI from \"./../apis/authorization\";\n\nexport default {\n  name: \"LogIn\",\n  data() {\n    return {\n      account: \"\",\n      password: \"\",\n      isProcessing: false,\n      errorMsg: \"\",\n    };\n  },\n  methods: {\n    async handleSubmit() {\n      try {\n        // 重新設定錯誤訊息\n        this.errorMsg = \"\";\n\n        // 表單驗證失敗：攔截惡意拿掉帳密 required 屬性而送出表單的狀況\n        if (!this.account || !this.password) {\n          // STEP1. 如果 email 或 password 為空，則使用 Toast 提示\n          Toast.fire({\n            icon: \"warning\",\n            title: \"請輸入帳號和密碼\",\n          });\n          // STEP2. 然後 return 不繼續往後執行\n          return;\n        }\n\n        // 表單驗證成功：帳密皆有填寫\n        // STEP1. 讓登入按鈕失效\n        this.isProcessing = true;\n\n        // STEP2. 將帳密透過 API 送回伺服器驗證\n        const { data } = await authorizationAPI.signIn({\n          account: this.account,\n          password: this.password,\n        });\n\n        // STEP3-1. 帳密驗證失敗，API 回傳錯誤\n        if (data.status === \"error\") {\n          throw new Error(data.message);\n        }\n\n        // STEP3-2. 帳密驗證成功\n        // 將 token 存在 localStorage 裡\n        localStorage.setItem(\"token\", data.token);\n\n        // 把 API 回傳的目前使用者資料存進 Vuex 裡\n        // this.$store.commit(\"setCurrentUser\", data.user);\n\n        // 登入成功, 直接轉址到首頁 （不需還原 isProcessing 的狀態）\n        this.$router.push(\"/main\");\n      } catch (error) {\n        // 帳號或密碼輸入錯誤後，將密碼欄位清空\n        this.password = \"\";\n\n        // 因為登入失敗，所以要把按鈕狀態還原\n        this.isProcessing = false;\n\n        // 錯誤通知處理\n        console.error(error.message);\n        this.errorMsg = error.message;\n        if (error.message === \"此帳號不存在!\") {\n          Toast.fire({\n            icon: \"error\",\n            title: \"帳號不存在，請重新確認\",\n          });\n        } else if (error.message === \"密碼錯誤!\") {\n          Toast.fire({\n            icon: \"error\",\n            title: \"密碼錯誤，請重新輸入\",\n          });\n        } else {\n          Toast.fire({\n            icon: \"error\",\n            title: \"無法登入，請稍後再試\",\n          });\n        }\n      }\n    },\n  },\n};\n</script>\n\n\n<style lang=\"scss\">\n@import \"../assets/scss/login.scss\";\n</style>"]}]}